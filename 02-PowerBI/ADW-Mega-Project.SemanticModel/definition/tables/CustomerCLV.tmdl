table CustomerCLV
	lineageTag: 68405980-1d63-4770-827c-7cc7361818a5

	column CustomerID
		formatString: 0
		lineageTag: 342beb8e-b53f-4f4b-9a10-5efe993071c3
		summarizeBy: count
		isNameInferred
		sourceColumn: DimCustomer[CustomerID]

		annotation SummarizationSetBy = Automatic

	column 'Customer Name'
		lineageTag: 8ddaa0ca-c06c-423b-b78e-c45a0f92ae50
		summarizeBy: none
		isNameInferred
		sourceColumn: [Customer Name]

		annotation SummarizationSetBy = Automatic

	column CLV
		lineageTag: c9229210-4534-4076-957f-adc3d73f44ef
		summarizeBy: sum
		isNameInferred
		sourceColumn: [CLV]

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'CLV Range' = ```
			
			SWITCH(
			    TRUE(), 
			    ISBLANK(CustomerCLV[CLV]), "No Purchases",
			    CustomerCLV[CLV] < 500, "< 500",
			    CustomerCLV[CLV] < 1000, "500 - 999",
			    CustomerCLV[CLV] < 5000, "1k - 4.9k",
			    CustomerCLV[CLV] < 10000, "5k - 9.9k",
			    "+10k"
			)
			```
		lineageTag: 92c19fd1-7277-4141-bbb7-2b129df9856a
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	partition CustomerCLV = calculated
		mode: import
		source =
				
				SUMMARIZE(
				    DimCustomer,
				    DimCustomer[CustomerID],
				    "Customer Name", SELECTEDVALUE(DimCustomer[CustomerName]),
				    "CLV", CALCULATE([Total Revenue])
				)

	annotation PBI_Id = e6a5a2648c4f425e94ddbc444c2bb7e2

